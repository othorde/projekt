{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Othor\\\\dbwebb-kurser\\\\frontendphp\\\\webbclient\\\\src\\\\components\\\\MoveBike\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport { React, useState, useContext } from \"react\";\nimport Api from \"../../api\";\nimport AppContext from \"../../AppContext\";\nimport { StyleMoveBike } from './Form.styles.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MoveBike(props) {\n  _s();\n\n  const myContext = useContext(AppContext);\n  const [charging_posts, setCharging_posts] = useState([]);\n  const [moveBikeToColor, setMoveBikeToColor] = useState({});\n  /* funktionen hämtar den stad där cykeln befinner sig \n     loopar igenom och sparar position och färgkod för laddningsstationen \n     Kontrollera denna när vi har fler laddningsstationer\n     Bör va graphQl sen\n     */\n\n  async function getLoadStationsForMovingBike() {\n    let city = await Api.getACity(props.city);\n    city[0].charging_posts.forEach(elem => {\n      setCharging_posts([elem]);\n    });\n  } // Vad behöver uppdateras?\n  // Scooterns plats ny long lat\n  // Uppdatera hur många som finns i föregående zon\n  // uppdatera hur många som finns i den nya zonen\n  // Fortsätt här när backend är klar\n  // glöm ej att hantera fail och error\n  // var lat = y_min + (Math.random() * (y_max - y_min)); // lat = y\n  // var lng = x_min + (Math.random() * (x_max - x_min)); //lng = x\n\n  /* Får vilken färgkod som scootern ska skickas till\n      kontrollerar med färger för staden\n      räknar ut nya koordinater. random plats inom zonen.\n      Uppdaterar, antal cyklar i nuvarande zon samt ny zon\n  */\n\n\n  const handleSubmit = async () => {\n    if (moveBikeToColor !== \"noValue\") {\n      let position = props.position;\n      let newPosition;\n      let movedBy = myContext.userHook.value;\n      let today = new Date();\n      let date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();\n      let time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\n      let dateTime = date + ' ' + time;\n      let active_user = null;\n      charging_posts.filter(elem => elem.color.includes(moveBikeToColor) ? newPosition = elem.position : position = null);\n\n      if (position !== null) {\n        var lat = newPosition.polygonePart1.lat + Math.random() * (newPosition.polygonePart4.lat - newPosition.polygonePart1.lat); // lat = y\n\n        var lng = newPosition.polygonePart1.lng + Math.random() * (newPosition.polygonePart4.lng - newPosition.polygonePart1.lng); //lng = x\n\n        newPosition = {\n          lat: lat,\n          lng: lng\n        };\n        var event = `${dateTime} \\n \n                    Moved(update) this bike (bikeId:${props.id}) \n                    from position: lat: ${props.position.lat} lng: ${props.position.lng} to the ${moveBikeToColor} zon. \n                    New exact position in zon: lat: ${newPosition.lat}, lng: ${newPosition.lng} .\n                    Speed is now 0 and battery is charged from ${props.battery} to 100%.\n                    This was carried out by ${movedBy}.\n                `;\n        let speed = \"0\";\n        let battery = \"100\";\n        let response = await Api.updateAScooter(props.id, speed, battery, newPosition); //uppdaterar scootern\n\n        console.log(\"FÖRSTA!!!!!\", response);\n\n        if (response && response.data) {\n          if (response.data.result === `'Object: ${props.id} updated'`) {\n            console.log(\"FÖRSTA\", response);\n            let resUpdateScooterUser = await Api.updateAScootersUser(props.id); //uppdaterar scooterns användare\n\n            console.log(\"ANDRA\", resUpdateScooterUser);\n\n            if (resUpdateScooterUser.data.result === `'Object: ${props.id} updated'`) {\n              let responseLogg = await Api.updateAScooter( //uppdaterar scooterns logg\n              props.id, active_user, event, props.position.lat, props.position.lng, dateTime, newPosition.lat, newPosition.lng, dateTime, newPosition);\n              console.log(\"TREJDE\", responseLogg);\n            }\n          }\n        }\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(StyleMoveBike, {\n    onClick: getLoadStationsForMovingBike,\n    children: [\" \", /*#__PURE__*/_jsxDEV(\"select\", {\n      \"data-testid\": \"dropdown\",\n      onChange: e => {\n        setMoveBikeToColor(e.target.value);\n      },\n      value: moveBikeToColor,\n      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n        value: 'noValue',\n        children: \"-- V\\xE4lj vart cykeln ska f\\xF6rflyttas --\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }, this), charging_posts.map(elem => elem !== null && /*#__PURE__*/_jsxDEV(\"option\", {\n        value: elem.color,\n        children: elem.color + \" zon\"\n      }, elem.color, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSubmit,\n      children: \" F\\xF6rflytta cykel \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MoveBike, \"rAQ8KNInSwdi1OJKD7UV8rDC6iY=\");\n\n_c = MoveBike;\n\nvar _c;\n\n$RefreshReg$(_c, \"MoveBike\");","map":{"version":3,"sources":["C:/Users/Othor/dbwebb-kurser/frontendphp/webbclient/src/components/MoveBike/index.js"],"names":["React","useState","useContext","Api","AppContext","StyleMoveBike","MoveBike","props","myContext","charging_posts","setCharging_posts","moveBikeToColor","setMoveBikeToColor","getLoadStationsForMovingBike","city","getACity","forEach","elem","handleSubmit","position","newPosition","movedBy","userHook","value","today","Date","date","getFullYear","getMonth","getDate","time","getHours","getMinutes","getSeconds","dateTime","active_user","filter","color","includes","lat","polygonePart1","Math","random","polygonePart4","lng","event","id","battery","speed","response","updateAScooter","console","log","data","result","resUpdateScooterUser","updateAScootersUser","responseLogg","e","target","map"],"mappings":"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","sourcesContent":["import {React, useState, useContext} from \"react\";\nimport Api from \"../../api\";\nimport AppContext from \"../../AppContext\";\nimport {StyleMoveBike} from './Form.styles.js'\nexport default function MoveBike(props) {\n    const myContext = useContext(AppContext);\n    const [charging_posts, setCharging_posts] = useState([])\n    const [moveBikeToColor, setMoveBikeToColor] = useState({})\n\n\n    /* funktionen hämtar den stad där cykeln befinner sig \n       loopar igenom och sparar position och färgkod för laddningsstationen \n       Kontrollera denna när vi har fler laddningsstationer\n       Bör va graphQl sen\n       */\n    async function getLoadStationsForMovingBike() {\n        let city = await Api.getACity(props.city);\n        city[0].charging_posts.forEach(elem => {\n            setCharging_posts([elem])\n        })\n    }\n\n    // Vad behöver uppdateras?\n    // Scooterns plats ny long lat\n    // Uppdatera hur många som finns i föregående zon\n    // uppdatera hur många som finns i den nya zonen\n    // Fortsätt här när backend är klar\n    // glöm ej att hantera fail och error\n    // var lat = y_min + (Math.random() * (y_max - y_min)); // lat = y\n    // var lng = x_min + (Math.random() * (x_max - x_min)); //lng = x\n    /* Får vilken färgkod som scootern ska skickas till\n        kontrollerar med färger för staden\n        räknar ut nya koordinater. random plats inom zonen.\n        Uppdaterar, antal cyklar i nuvarande zon samt ny zon\n    */\n    const handleSubmit = async () => {\n        if (moveBikeToColor !== \"noValue\") {\n\n            let position = props.position;\n            let newPosition;\n            let movedBy = myContext.userHook.value\n            let today = new Date();\n            let date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\n            let time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\n            let dateTime = date+' '+time;\n            let active_user = null;\n\n            charging_posts.filter(elem=> elem.color.includes(moveBikeToColor) ? newPosition = elem.position : position = null)\n            if (position !== null) {\n                var lat = newPosition.polygonePart1.lat + (Math.random() * (newPosition.polygonePart4.lat - newPosition.polygonePart1.lat)); // lat = y\n                var lng = newPosition.polygonePart1.lng + (Math.random() * (newPosition.polygonePart4.lng - newPosition.polygonePart1.lng)); //lng = x\n                newPosition = {lat: lat, lng: lng}\n                var event = `${dateTime} \\n \n                    Moved(update) this bike (bikeId:${props.id}) \n                    from position: lat: ${props.position.lat} lng: ${props.position.lng} to the ${moveBikeToColor} zon. \n                    New exact position in zon: lat: ${newPosition.lat}, lng: ${newPosition.lng} .\n                    Speed is now 0 and battery is charged from ${props.battery} to 100%.\n                    This was carried out by ${movedBy}.\n                `;\n                let speed = \"0\";\n                let battery = \"100\";\n                let response = await Api.updateAScooter(props.id, speed, battery, newPosition); //uppdaterar scootern\n                console.log(\"FÖRSTA!!!!!\", response)\n\n                if (response && response.data) {\n                    if(response.data.result === `'Object: ${props.id} updated'`) {\n                        console.log(\"FÖRSTA\", response)\n\n                        let resUpdateScooterUser = await Api.updateAScootersUser(props.id);  //uppdaterar scooterns användare\n                        console.log(\"ANDRA\", resUpdateScooterUser)\n\n                        if(resUpdateScooterUser.data.result === `'Object: ${props.id} updated'`) {\n                            let responseLogg = await Api.updateAScooter( //uppdaterar scooterns logg\n                                props.id,\n                                active_user,\n                                event,\n                                props.position.lat,\n                                props.position.lng,\n                                dateTime,\n                                newPosition.lat,\n                                newPosition.lng,\n                                dateTime,\n                                newPosition\n                                );\n                                console.log(\"TREJDE\", responseLogg)\n                            }\n                    }\n                }\n            }   \n        }\n    }\n\n\treturn (\n        <StyleMoveBike onClick = {getLoadStationsForMovingBike}> {/* laddar in ny info med onClick */}\n            <select \n                data-testid=\"dropdown\" onChange={(e) => {\n                setMoveBikeToColor((e.target.value))\n            }}\n            value = {moveBikeToColor}\n            >\n            <option value={'noValue'}>-- Välj vart cykeln ska förflyttas --</option>\n            {charging_posts.map(elem => elem !== null  &&\n                <option key={elem.color}value={elem.color}>\n                {elem.color + \" zon\"}\n                </option> )}\n            </select>\n            <button onClick={handleSubmit}> Förflytta cykel </button>\n        </StyleMoveBike>\n\t);\n}\n\n\n"]},"metadata":{},"sourceType":"module"}