{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport Api from '../Api';\nlet initalValue = {\n  showLoadStations: false,\n  loadStations: []\n};\n/* useDisplayPolyChargeStation sätter polygons(laddstationer) på kartan\n   genom att hämta från db och sen skriva ut. mapRef är kartan. Tar mot props om \n   den ska tas bort från kartan/läggas till.\n*/\n\nconst useDisplayPolyChargeStation = (mapRef, _ref) => {\n  _s();\n\n  let {\n    ifToShowLoadStations\n  } = _ref;\n  const [loadStationObject, setLoadStationObject] = useState([]); // sparar objektet i state så att man kan ta bort det från kartan\n\n  const [loadStationContent, setLoadStationContent] = useState(initalValue); // håller content för onClick\n\n  const [loadStationError, setLoadStationError] = useState(false); // håller content för onClick\n  // funktion som kan toggla state, används från map\n\n  const showInfoForLoadStation = trueOrFalse => {\n    setLoadStationContent({\n      showLoadStations: trueOrFalse\n    });\n  }; // Om props ändras samt vid mount.\n  // Är props true hämta data. Om false ta bort från karta\n\n\n  useEffect(() => {\n    /* loopar igenom res från db, tar ut alla koordinatera som\n       är laddstationer, skapar sedan ny polygon med dessa\n       och lägger på ett klickevent. Sparar obj i state\n       så att det senare kan tas bort\n    */\n    const handleSucces = res => {\n      var loadStationName;\n      const map = mapRef.current.map;\n      const maps = mapRef.current.maps;\n      res.forEach(cityCoords => {\n        cityCoords.charging_posts.forEach(loadStations => {\n          let polyGon = [loadStations.position.polygonePart1, loadStations.position.polygonePart2, loadStations.position.polygonePart3, loadStations.position.polygonePart4];\n          loadStationName = new maps.Polygon({\n            paths: polyGon,\n            strokeColor: loadStations.color,\n            strokeOpacity: 0.9,\n            strokeWeight: 2,\n            fillColor: \"transparent\",\n            fillOpacity: 0.35\n          });\n          loadStationName.addListener('click', () => {\n            setLoadStationContent(prevState => ({\n              showLoadStations: !prevState.showLoadStations,\n              loadStations\n            }));\n          });\n          loadStationName.setMap(map); // Kopierar tidigare state + lägger in nytt element sedan sätter state\n\n          var holdArr = loadStationObject;\n          holdArr.push(loadStationName);\n          setLoadStationObject(holdArr);\n        });\n      });\n    }; // tar bort loadinstations från kartan genom att sätta mapobj som är sparat i state till null.\n    // Sker endast om ifToShowLoadStations.loadStation är false i tennaryoperator nedan i useEffect\n\n\n    function removeLoadingStationsFromMap() {\n      loadStationContent !== null && loadStationObject.forEach(loadStation => {\n        loadStation.setMap(null);\n      });\n    }\n\n    const getData = async () => {\n      try {\n        setLoadStationError(false);\n        let res = await Api.getAllCitys();\n        handleSucces(res);\n      } catch (error) {\n        setLoadStationError(true);\n      }\n    }; // Hämta data endast vid if\n\n\n    if (ifToShowLoadStations.loadStation) {\n      getData();\n      const interval = setInterval(() => {\n        getData();\n      }, 10000);\n      return () => clearInterval(interval);\n    }\n\n    ifToShowLoadStations.loadStation === false && removeLoadingStationsFromMap();\n  }, [ifToShowLoadStations.loadStation, mapRef]);\n  return {\n    loadStationObject,\n    loadStationContent,\n    loadStationError,\n    showInfoForLoadStation\n  };\n};\n\n_s(useDisplayPolyChargeStation, \"AVzT48Wg0hJquwML8FgwtjqT1z4=\");\n\nexport default useDisplayPolyChargeStation;","map":{"version":3,"sources":["C:/Users/Othor/dbwebb-kurser/frontendphp/webbclient/src/Hooks/useDisplayPolyChargeStation.js"],"names":["useState","useEffect","Api","initalValue","showLoadStations","loadStations","useDisplayPolyChargeStation","mapRef","ifToShowLoadStations","loadStationObject","setLoadStationObject","loadStationContent","setLoadStationContent","loadStationError","setLoadStationError","showInfoForLoadStation","trueOrFalse","handleSucces","res","loadStationName","map","current","maps","forEach","cityCoords","charging_posts","polyGon","position","polygonePart1","polygonePart2","polygonePart3","polygonePart4","Polygon","paths","strokeColor","color","strokeOpacity","strokeWeight","fillColor","fillOpacity","addListener","prevState","setMap","holdArr","push","removeLoadingStationsFromMap","loadStation","getData","getAllCitys","error","interval","setInterval","clearInterval"],"mappings":"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","sourcesContent":["import {useState, useEffect} from 'react';\nimport Api from '../Api';\n\nlet initalValue = {\n\tshowLoadStations: false,\n\tloadStations: []\n}\n\n/* useDisplayPolyChargeStation sätter polygons(laddstationer) på kartan\n   genom att hämta från db och sen skriva ut. mapRef är kartan. Tar mot props om \n   den ska tas bort från kartan/läggas till.\n*/\nconst useDisplayPolyChargeStation = (mapRef, {ifToShowLoadStations}) => {\n    const[loadStationObject, setLoadStationObject] = useState([]); // sparar objektet i state så att man kan ta bort det från kartan\n    const[loadStationContent, setLoadStationContent] = useState(initalValue); // håller content för onClick\n    const[loadStationError, setLoadStationError] = useState(false); // håller content för onClick\n\n\n    // funktion som kan toggla state, används från map\n    const showInfoForLoadStation = (trueOrFalse) => {\n        setLoadStationContent({ showLoadStations: trueOrFalse});\n\t}\n\n    // Om props ändras samt vid mount.\n    // Är props true hämta data. Om false ta bort från karta\n    useEffect(()=>{\n\n    /* loopar igenom res från db, tar ut alla koordinatera som\n       är laddstationer, skapar sedan ny polygon med dessa\n       och lägger på ett klickevent. Sparar obj i state\n       så att det senare kan tas bort\n    */\n        const handleSucces = (res) => {\n            var loadStationName;\n            const map = mapRef.current.map;\n            const maps = mapRef.current.maps;\n        \n            res.forEach(cityCoords => {\n                cityCoords.charging_posts.forEach(loadStations => {         \n                    let polyGon = \n                        ([\n                            loadStations.position.polygonePart1,\n                            loadStations.position.polygonePart2,\n                            loadStations.position.polygonePart3,\n                            loadStations.position.polygonePart4,\n                        ]);\n                    loadStationName = new maps.Polygon({\n                        paths: polyGon,\n                        strokeColor: loadStations.color,\n                        strokeOpacity: 0.9,\n                        strokeWeight: 2,\n                        fillColor: \"transparent\",\n                        fillOpacity: 0.35,\n                        });\n                    \n                    loadStationName.addListener('click', () => {\n                        setLoadStationContent(prevState => ({\n                            showLoadStations: !prevState.showLoadStations,\n                            loadStations\n                        }));\n                    });\n                loadStationName.setMap(map);\n                // Kopierar tidigare state + lägger in nytt element sedan sätter state\n                var holdArr = loadStationObject;\n                holdArr.push(loadStationName);\n                setLoadStationObject(holdArr);\n                })\n\n            })\n        };\n\n        // tar bort loadinstations från kartan genom att sätta mapobj som är sparat i state till null.\n        // Sker endast om ifToShowLoadStations.loadStation är false i tennaryoperator nedan i useEffect\n        function removeLoadingStationsFromMap() {\n            loadStationContent !== null && loadStationObject.forEach(loadStation => {\n                loadStation.setMap(null);\n            })\n        }\n\n        const getData = async () => {\n            try {\n                setLoadStationError(false)\n                let res = await Api.getAllCitys();\n                handleSucces(res)\n            } catch (error) {\n                setLoadStationError(true)\n            }\n        }\n        // Hämta data endast vid if\n        if(ifToShowLoadStations.loadStation) {\n            getData()\n            const interval=setInterval(()=>{\n                getData()\n            }, 10000)\n            return()=>clearInterval(interval)\n        }\n        ifToShowLoadStations.loadStation === false && removeLoadingStationsFromMap()\n\n\n    },[ifToShowLoadStations.loadStation, mapRef])\n\n    return {loadStationObject, loadStationContent, loadStationError, showInfoForLoadStation};\n}\nexport default useDisplayPolyChargeStation;\n\n"]},"metadata":{},"sourceType":"module"}