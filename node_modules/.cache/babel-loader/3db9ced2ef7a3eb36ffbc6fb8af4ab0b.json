{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport Api from '../api';\nlet initalValue = {\n  showLoadStations: false,\n  loadStations: []\n};\n\nconst useLoadStationToMap = (mapRef, props) => {\n  _s();\n\n  const [loadStationObject, setLoadStationObject] = useState([]); // håller objektet så att man kan ta bort det från kartan\n\n  const [loadStationContent, setLoadStationContent] = useState(initalValue); // håller content för onClick\n  // sparar res i state, så slipper hämta från servern hela tiden. Kanske ändra om vi ska köra nån realtime\n\n  const [resFromApi, setResFromApi] = useState(null);\n  const [error1, setError1] = useState();\n\n  const handleSucces = res => {\n    var loadStationName;\n    const map = mapRef.current.map;\n    const maps = mapRef.current.maps;\n    res.forEach(cityCoords => {\n      cityCoords.charging_posts.forEach(loadStations => {\n        let polyGon = [loadStations.position.polygonePart1, loadStations.position.polygonePart2, loadStations.position.polygonePart3, loadStations.position.polygonePart4];\n        loadStationName = new maps.Polygon({\n          paths: polyGon,\n          strokeColor: loadStations.color,\n          strokeOpacity: 0.9,\n          strokeWeight: 2,\n          fillColor: \"transparent\",\n          fillOpacity: 0.35\n        });\n        loadStationName.addListener('click', event => {\n          setLoadStationContent(prevState => ({\n            showLoadStations: !prevState.showLoadStations,\n            loadStations\n          }));\n        });\n        /* Kopierar tidigare state + lägger in nytt element\n        sedan sätter state = holdArr => arbetar ej direkt mot state */\n\n        loadStationName.setMap(map);\n        var holdArr = loadStationObject;\n        holdArr.push(loadStationName);\n        setLoadStationObject(holdArr);\n      });\n    });\n  }; // funktion som kan toggla state, från andra komponenter\n\n\n  const showInfoForLoadStation = trueOrFalse => {\n    setLoadStationContent({\n      showLoadStations: trueOrFalse\n    });\n  };\n\n  const handleError = error => {\n    setError1(error.message);\n  }; // tar bort loadinstations från kartan, Ska man rensa i states? Isf kommer backend att kallas.\n  // Kommer behövas om man ska få realtiduppdateringar, typ timer\n\n\n  function removeLoadingStationsFromMap() {\n    if (loadStationObject !== null) {\n      loadStationObject.forEach(loadStation => {\n        console.log(loadStationObject);\n        loadStation.setMap(null);\n      });\n    }\n\n    return;\n  }\n\n  useEffect(async () => {\n    // Om loadStations ska tas bort från kartan\n    if (props.ifToShowLoadStations.loadStation === false) {\n      removeLoadingStationsFromMap(mapRef);\n      return;\n    } // Om state är null == ej hämtat från backend ännu\n\n\n    if (resFromApi === null) {\n      let res = await Api.getAllCitys();\n      setResFromApi(res);\n      handleSucces(res); // Annars använd det som är sparat i state\n    } else if (resFromApi != null) {\n      handleSucces(resFromApi);\n    } else {\n      handleError(\"Error\");\n      return;\n    }\n  }, [mapRef, props.ifToShowLoadStations.loadStation]);\n  return {\n    loadStationObject,\n    loadStationContent,\n    error1,\n    showInfoForLoadStation\n  };\n};\n\n_s(useLoadStationToMap, \"tHNgwmDH1OyJYMbhvKssuWc7S30=\");\n\nexport default useLoadStationToMap;","map":{"version":3,"sources":["C:/Users/Othor/dbwebb-kurser/frontendphp/webbclient/src/Hooks/loadStationsToMap.js"],"names":["useState","useEffect","Api","initalValue","showLoadStations","loadStations","useLoadStationToMap","mapRef","props","loadStationObject","setLoadStationObject","loadStationContent","setLoadStationContent","resFromApi","setResFromApi","error1","setError1","handleSucces","res","loadStationName","map","current","maps","forEach","cityCoords","charging_posts","polyGon","position","polygonePart1","polygonePart2","polygonePart3","polygonePart4","Polygon","paths","strokeColor","color","strokeOpacity","strokeWeight","fillColor","fillOpacity","addListener","event","prevState","setMap","holdArr","push","showInfoForLoadStation","trueOrFalse","handleError","error","message","removeLoadingStationsFromMap","loadStation","console","log","ifToShowLoadStations","getAllCitys"],"mappings":";;AAAA,SAAQA,QAAR,EAAkBC,SAAlB,QAAkC,OAAlC;AACA,OAAOC,GAAP,MAAgB,QAAhB;AAEA,IAAIC,WAAW,GAAG;AACjBC,EAAAA,gBAAgB,EAAE,KADD;AAEjBC,EAAAA,YAAY,EAAE;AAFG,CAAlB;;AAKA,MAAMC,mBAAmB,GAAG,CAACC,MAAD,EAASC,KAAT,KAAmB;AAAA;;AAC3C,QAAK,CAACC,iBAAD,EAAoBC,oBAApB,IAA4CV,QAAQ,CAAC,EAAD,CAAzD,CAD2C,CACoB;;AAC/D,QAAK,CAACW,kBAAD,EAAqBC,qBAArB,IAA8CZ,QAAQ,CAACG,WAAD,CAA3D,CAF2C,CAE+B;AAC1E;;AACA,QAAK,CAACU,UAAD,EAAaC,aAAb,IAA8Bd,QAAQ,CAAC,IAAD,CAA3C;AACA,QAAM,CAACe,MAAD,EAASC,SAAT,IAAsBhB,QAAQ,EAApC;;AACA,QAAMiB,YAAY,GAAIC,GAAD,IAAS;AAC9B,QAAIC,eAAJ;AACA,UAAMC,GAAG,GAAGb,MAAM,CAACc,OAAP,CAAeD,GAA3B;AACA,UAAME,IAAI,GAAGf,MAAM,CAACc,OAAP,CAAeC,IAA5B;AAEAJ,IAAAA,GAAG,CAACK,OAAJ,CAAYC,UAAU,IAAI;AACtBA,MAAAA,UAAU,CAACC,cAAX,CAA0BF,OAA1B,CAAkClB,YAAY,IAAI;AAC9C,YAAIqB,OAAO,GACN,CACGrB,YAAY,CAACsB,QAAb,CAAsBC,aADzB,EAEGvB,YAAY,CAACsB,QAAb,CAAsBE,aAFzB,EAGGxB,YAAY,CAACsB,QAAb,CAAsBG,aAHzB,EAIGzB,YAAY,CAACsB,QAAb,CAAsBI,aAJzB,CADL;AAOAZ,QAAAA,eAAe,GAAG,IAAIG,IAAI,CAACU,OAAT,CAAiB;AAC/BC,UAAAA,KAAK,EAAEP,OADwB;AAE/BQ,UAAAA,WAAW,EAAE7B,YAAY,CAAC8B,KAFK;AAG/BC,UAAAA,aAAa,EAAE,GAHgB;AAI/BC,UAAAA,YAAY,EAAE,CAJiB;AAK/BC,UAAAA,SAAS,EAAE,aALoB;AAM/BC,UAAAA,WAAW,EAAE;AANkB,SAAjB,CAAlB;AASApB,QAAAA,eAAe,CAACqB,WAAhB,CAA4B,OAA5B,EAAsCC,KAAD,IAAW;AAC5C7B,UAAAA,qBAAqB,CAAC8B,SAAS,KAAK;AAChCtC,YAAAA,gBAAgB,EAAE,CAACsC,SAAS,CAACtC,gBADG;AAEhCC,YAAAA;AAFgC,WAAL,CAAV,CAArB;AAIH,SALD;AAMJ;AACR;;AACQc,QAAAA,eAAe,CAACwB,MAAhB,CAAuBvB,GAAvB;AACA,YAAIwB,OAAO,GAAGnC,iBAAd;AACAmC,QAAAA,OAAO,CAACC,IAAR,CAAa1B,eAAb;AACAT,QAAAA,oBAAoB,CAACkC,OAAD,CAApB;AACC,OA7BD;AA+BH,KAhCD;AAiCH,GAtCG,CAN2C,CA8C3C;;;AACA,QAAME,sBAAsB,GAAIC,WAAD,IAAiB;AAC5CnC,IAAAA,qBAAqB,CAAC;AAAER,MAAAA,gBAAgB,EAAE2C;AAApB,KAAD,CAArB;AACN,GAFE;;AAIA,QAAMC,WAAW,GAAIC,KAAD,IAAW;AAC3BjC,IAAAA,SAAS,CAACiC,KAAK,CAACC,OAAP,CAAT;AACH,GAFD,CAnD2C,CAuD3C;AACA;;;AACH,WAASC,4BAAT,GAAwC;AACvC,QAAI1C,iBAAiB,KAAK,IAA1B,EAAgC;AAC/BA,MAAAA,iBAAiB,CAACc,OAAlB,CAA0B6B,WAAW,IAAI;AAC5BC,QAAAA,OAAO,CAACC,GAAR,CAAY7C,iBAAZ;AACZ2C,QAAAA,WAAW,CAACT,MAAZ,CAAmB,IAAnB;AACA,OAHD;AAIA;;AACK;AACN;;AAEE1C,EAAAA,SAAS,CAAC,YAAY;AAClB;AACA,QAAIO,KAAK,CAAC+C,oBAAN,CAA2BH,WAA3B,KAA2C,KAA/C,EAAuD;AACnDD,MAAAA,4BAA4B,CAAC5C,MAAD,CAA5B;AACA;AACH,KALiB,CAMlB;;;AACA,QAAIM,UAAU,KAAK,IAAnB,EAAyB;AACrB,UAAIK,GAAG,GAAG,MAAMhB,GAAG,CAACsD,WAAJ,EAAhB;AACA1C,MAAAA,aAAa,CAACI,GAAD,CAAb;AACAD,MAAAA,YAAY,CAACC,GAAD,CAAZ,CAHqB,CAIzB;AACC,KALD,MAKO,IAAIL,UAAU,IAAI,IAAlB,EAAwB;AAC3BI,MAAAA,YAAY,CAACJ,UAAD,CAAZ;AACH,KAFM,MAEA;AACHmC,MAAAA,WAAW,CAAC,OAAD,CAAX;AACA;AACH;AACJ,GAlBQ,EAkBP,CAACzC,MAAD,EAASC,KAAK,CAAC+C,oBAAN,CAA2BH,WAApC,CAlBO,CAAT;AAoBA,SAAO;AAAC3C,IAAAA,iBAAD;AAAoBE,IAAAA,kBAApB;AAAwCI,IAAAA,MAAxC;AAAgD+B,IAAAA;AAAhD,GAAP;AACH,CAxFD;;GAAMxC,mB;;AAyFN,eAAeA,mBAAf","sourcesContent":["import {useState, useEffect} from 'react';\nimport Api from '../api';\n\nlet initalValue = {\n\tshowLoadStations: false,\n\tloadStations: []\n}\n\nconst useLoadStationToMap = (mapRef, props) => {\n    const[loadStationObject, setLoadStationObject] = useState([]); // håller objektet så att man kan ta bort det från kartan\n    const[loadStationContent, setLoadStationContent] = useState(initalValue); // håller content för onClick\n    // sparar res i state, så slipper hämta från servern hela tiden. Kanske ändra om vi ska köra nån realtime\n    const[resFromApi, setResFromApi] = useState(null); \n    const [error1, setError1] = useState();\n    const handleSucces = (res) => {\n    var loadStationName;\n    const map = mapRef.current.map;\n    const maps = mapRef.current.maps;\n\n    res.forEach(cityCoords => {\n        cityCoords.charging_posts.forEach(loadStations => {         \n            let polyGon = \n                ([\n                    loadStations.position.polygonePart1,\n                    loadStations.position.polygonePart2,\n                    loadStations.position.polygonePart3,\n                    loadStations.position.polygonePart4,\n                ]);\n            loadStationName = new maps.Polygon({\n                paths: polyGon,\n                strokeColor: loadStations.color,\n                strokeOpacity: 0.9,\n                strokeWeight: 2,\n                fillColor: \"transparent\",\n                fillOpacity: 0.35,\n                });\n            \n            loadStationName.addListener('click', (event) => {\n                setLoadStationContent(prevState => ({\n                    showLoadStations: !prevState.showLoadStations,\n                    loadStations\n                }));\n            });\n        /* Kopierar tidigare state + lägger in nytt element\n        sedan sätter state = holdArr => arbetar ej direkt mot state */\n        loadStationName.setMap(map);\n        var holdArr = loadStationObject;\n        holdArr.push(loadStationName);\n        setLoadStationObject(holdArr);\n        })\n\n    })\n};\n\n    // funktion som kan toggla state, från andra komponenter\n    const showInfoForLoadStation = (trueOrFalse) => {\n        setLoadStationContent({ showLoadStations: trueOrFalse});\n\t}\n\n    const handleError = (error) => {\n        setError1(error.message);\n    };\n\n    // tar bort loadinstations från kartan, Ska man rensa i states? Isf kommer backend att kallas.\n    // Kommer behövas om man ska få realtiduppdateringar, typ timer\n\tfunction removeLoadingStationsFromMap() { \n\t\tif (loadStationObject !== null) {\n\t\t\tloadStationObject.forEach(loadStation => {\n                console.log(loadStationObject)\n\t\t\t\tloadStation.setMap(null);\n\t\t\t})\n\t\t}\n        return\n\t}\n\n    useEffect(async () => {\n        // Om loadStations ska tas bort från kartan\n        if (props.ifToShowLoadStations.loadStation === false ) {\n            removeLoadingStationsFromMap(mapRef)\n            return\n        }\n        // Om state är null == ej hämtat från backend ännu\n        if (resFromApi === null) {\n            let res = await Api.getAllCitys();\n            setResFromApi(res);\n            handleSucces(res)\n        // Annars använd det som är sparat i state\n        } else if (resFromApi != null) {\n            handleSucces(resFromApi);\n        } else {\n            handleError(\"Error\")\n            return;\n        }\n    },[mapRef, props.ifToShowLoadStations.loadStation])\n    \n    return {loadStationObject, loadStationContent, error1, showInfoForLoadStation};\n};\nexport default useLoadStationToMap;\n\n"]},"metadata":{},"sourceType":"module"}