{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport Api from '../api';\nlet initalValue = {\n  showLoadStations: false,\n  loadStations: []\n};\n/* useDisplayPolyChargeStation sätter polygons(laddstationer) på kartan\n   genom att hämta från db och sen skriva ut. mapRef är kartan. Tar mot props om \n   den ska tas bort från kartan/läggas till.\n*/\n\nconst useDisplayPolyChargeStation = (mapRef, props) => {\n  _s();\n\n  const [loadStationObject, setLoadStationObject] = useState([]); // sparar objektet i state så att man kan ta bort det från kartan\n\n  const [loadStationContent, setLoadStationContent] = useState(initalValue); // håller content för onClick\n\n  const [resFromApi, setResFromApi] = useState(null);\n  /* loopar igenom res från db, tar ut alla koordinatera som\n     är laddstationer \n  */\n\n  const handleSucces = res => {\n    var loadStationName;\n    const map = mapRef.current.map;\n    const maps = mapRef.current.maps;\n    res.forEach(cityCoords => {\n      cityCoords.charging_posts.forEach(loadStations => {\n        let polyGon = [loadStations.position.polygonePart1, loadStations.position.polygonePart2, loadStations.position.polygonePart3, loadStations.position.polygonePart4];\n        loadStationName = new maps.Polygon({\n          paths: polyGon,\n          strokeColor: loadStations.color,\n          strokeOpacity: 0.9,\n          strokeWeight: 2,\n          fillColor: \"transparent\",\n          fillOpacity: 0.35\n        });\n        loadStationName.addListener('click', event => {\n          setLoadStationContent(prevState => ({\n            showLoadStations: !prevState.showLoadStations,\n            loadStations\n          }));\n        }); // Kopierar tidigare state + lägger in nytt element sedan sätter state\n\n        loadStationName.setMap(map);\n        var holdArr = loadStationObject;\n        holdArr.push(loadStationName);\n        setLoadStationObject(holdArr);\n      });\n    });\n  }; // funktion som kan toggla state, från andra komponenter\n\n\n  const showInfoForLoadStation = trueOrFalse => {\n    setLoadStationContent({\n      showLoadStations: trueOrFalse\n    });\n  }; // tar bort loadinstations från kartan, Ska man rensa i states? Isf kommer backend att kallas.\n\n\n  function removeLoadingStationsFromMap() {\n    if (loadStationObject !== null) {\n      loadStationObject.forEach(loadStation => {\n        loadStation.setMap(null);\n      });\n    }\n\n    return;\n  }\n\n  useEffect(() => {\n    console.log(\"HÄR !\");\n    !props.ifToShowLoadStations.loadStation ? removeLoadingStationsFromMap(mapRef) : getData();\n\n    const getData = async () => {\n      console.log(\"HÄR 2\");\n      let res = await Api.getAllCitys();\n      setResFromApi(res);\n      handleSucces(res);\n    };\n  }, [props.ifToShowLoadStations.loadStation]); // useEffect(async () => {\n  //     // Om loadStations ska tas bort från kartan\n  //     if (props.ifToShowLoadStations.loadStation === false ) {\n  //         removeLoadingStationsFromMap(mapRef)\n  //         return\n  //     }\n  //     // Om state är null == ej hämtat från backend ännu\n  //     if (resFromApi === null) {\n  //         let res = await Api.getAllCitys();\n  //         setResFromApi(res);\n  //         handleSucces(res)\n  //     // Annars använd det som är sparat i state\n  //     } else if (resFromApi != null) {\n  //         handleSucces(resFromApi);\n  //     } else {\n  //         handleError(\"Error\")\n  //         return;\n  //     }\n  // },[mapRef, props.ifToShowLoadStations.loadStation])\n\n  return {\n    loadStationObject,\n    loadStationContent,\n    showInfoForLoadStation\n  };\n};\n\n_s(useDisplayPolyChargeStation, \"1iXn5f6yvvOQAZIN56OVShMBIL0=\");\n\nexport default useDisplayPolyChargeStation;","map":{"version":3,"sources":["C:/Users/Othor/dbwebb-kurser/frontendphp/webbclient/src/Hooks/useDisplayPolyChargeStation.js"],"names":["useState","useEffect","Api","initalValue","showLoadStations","loadStations","useDisplayPolyChargeStation","mapRef","props","loadStationObject","setLoadStationObject","loadStationContent","setLoadStationContent","resFromApi","setResFromApi","handleSucces","res","loadStationName","map","current","maps","forEach","cityCoords","charging_posts","polyGon","position","polygonePart1","polygonePart2","polygonePart3","polygonePart4","Polygon","paths","strokeColor","color","strokeOpacity","strokeWeight","fillColor","fillOpacity","addListener","event","prevState","setMap","holdArr","push","showInfoForLoadStation","trueOrFalse","removeLoadingStationsFromMap","loadStation","console","log","ifToShowLoadStations","getData","getAllCitys"],"mappings":"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","sourcesContent":["import {useState, useEffect} from 'react';\nimport Api from '../api';\n\nlet initalValue = {\n\tshowLoadStations: false,\n\tloadStations: []\n}\n\n/* useDisplayPolyChargeStation sätter polygons(laddstationer) på kartan\n   genom att hämta från db och sen skriva ut. mapRef är kartan. Tar mot props om \n   den ska tas bort från kartan/läggas till.\n*/\nconst useDisplayPolyChargeStation = (mapRef, props) => {\n    const[loadStationObject, setLoadStationObject] = useState([]); // sparar objektet i state så att man kan ta bort det från kartan\n    const[loadStationContent, setLoadStationContent] = useState(initalValue); // håller content för onClick\n    const[resFromApi, setResFromApi] = useState(null); \n    \n    /* loopar igenom res från db, tar ut alla koordinatera som\n       är laddstationer \n    */\n    const handleSucces = (res) => {\n        var loadStationName;\n        const map = mapRef.current.map;\n        const maps = mapRef.current.maps;\n    \n        res.forEach(cityCoords => {\n            cityCoords.charging_posts.forEach(loadStations => {         \n                let polyGon = \n                    ([\n                        loadStations.position.polygonePart1,\n                        loadStations.position.polygonePart2,\n                        loadStations.position.polygonePart3,\n                        loadStations.position.polygonePart4,\n                    ]);\n                loadStationName = new maps.Polygon({\n                    paths: polyGon,\n                    strokeColor: loadStations.color,\n                    strokeOpacity: 0.9,\n                    strokeWeight: 2,\n                    fillColor: \"transparent\",\n                    fillOpacity: 0.35,\n                    });\n                \n                loadStationName.addListener('click', (event) => {\n                    setLoadStationContent(prevState => ({\n                        showLoadStations: !prevState.showLoadStations,\n                        loadStations\n                    }));\n                });\n            // Kopierar tidigare state + lägger in nytt element sedan sätter state\n            loadStationName.setMap(map);\n            var holdArr = loadStationObject;\n            holdArr.push(loadStationName);\n            setLoadStationObject(holdArr);\n            })\n\n        })\n    };\n\n    // funktion som kan toggla state, från andra komponenter\n    const showInfoForLoadStation = (trueOrFalse) => {\n        setLoadStationContent({ showLoadStations: trueOrFalse});\n\t}\n\n    // tar bort loadinstations från kartan, Ska man rensa i states? Isf kommer backend att kallas.\n\tfunction removeLoadingStationsFromMap() { \n\t\tif (loadStationObject !== null) {\n\t\t\tloadStationObject.forEach(loadStation => {\n\t\t\t\tloadStation.setMap(null);\n\t\t\t})\n\t\t}\n        return\n\t}\n\n    useEffect(() => {\n        console.log(\"HÄR !\")\n        !props.ifToShowLoadStations.loadStation ? (removeLoadingStationsFromMap(mapRef)) : (getData())\n\n        const getData = async () => {\n            console.log(\"HÄR 2\")\n\n            let res = await Api.getAllCitys();\n            setResFromApi(res);\n            handleSucces(res)\n        }\n  \n      \n     \n    }, [props.ifToShowLoadStations.loadStation])\n\n    // useEffect(async () => {\n    //     // Om loadStations ska tas bort från kartan\n    //     if (props.ifToShowLoadStations.loadStation === false ) {\n    //         removeLoadingStationsFromMap(mapRef)\n    //         return\n    //     }\n    //     // Om state är null == ej hämtat från backend ännu\n    //     if (resFromApi === null) {\n    //         let res = await Api.getAllCitys();\n    //         setResFromApi(res);\n    //         handleSucces(res)\n    //     // Annars använd det som är sparat i state\n    //     } else if (resFromApi != null) {\n    //         handleSucces(resFromApi);\n    //     } else {\n    //         handleError(\"Error\")\n    //         return;\n    //     }\n    // },[mapRef, props.ifToShowLoadStations.loadStation])\n    \n    return {loadStationObject, loadStationContent, showInfoForLoadStation};\n};\nexport default useDisplayPolyChargeStation;\n\n"]},"metadata":{},"sourceType":"module"}